# 7ALA Reservation Website

Professional dark-theme reservation flow inspired by premium event booking pages.

## Features
- Event information section with lineup and entry policy.
- Reservation form with selective entry fields.
- Payment method options:
  - Instapay: `01155650877`
  - Wallet transfer: `01020840820`
- Server-side QR ticket generation.
- Ticket email sending after payment form submission.
- **Single-use QR validation for organizers** (ticket becomes invalid after first scan).
- Supabase reservation storage.

## Setup
1. Install dependencies:
   ```bash
   npm install
   ```
2. Create `.env` from `.env.example` and set values.
3. Create/update Supabase table:
   ```sql
   create table if not exists reservations (
     id bigint generated by default as identity primary key,
     reservation_id text unique not null,
     ticket_code text unique not null,
     full_name text not null,
     email text not null,
     phone text not null,
     guests int not null,
     group_type text not null,
     payment_method text not null,
     payment_reference text not null,
     payment_amount numeric,
     qr_code_data_url text,
     qr_payload jsonb,
     status text default 'paid_pending_review',
     scan_count int default 0,
     scanned_at timestamptz,
     created_at timestamptz default now()
   );

   alter table reservations add column if not exists qr_payload jsonb;
   alter table reservations add column if not exists scan_count int default 0;
   alter table reservations add column if not exists scanned_at timestamptz;
   ```
4. Run:
   ```bash
   npm run dev
   ```

Open `http://localhost:3000`.

## Check-In Logic
- Guests receive a QR code by email.
- QR code points to `/check-in/:ticketCode`.
- Organizer must enter `ORGANIZER_SCAN_PIN` to validate.
- Once scanned successfully, the reservation is marked `checked_in`, and the same QR cannot be scanned again.

## Notes
- Email requires SMTP credentials in `.env`.
- Supabase write operations require `SUPABASE_SERVICE_KEY`.
- Keep `ORGANIZER_SCAN_PIN` secret and rotate it before each event.
